---
title: "Factor and Figure Management"
author: "Gokul Raj Suresh Kumar"
date: "`r format(Sys.Date())`"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#Factor and Figure Management

####Loading the required packages

```{r message=FALSE}
library(gapminder)
library(tidyverse)
library(forcats)
```

##Factor Management

###Dropping Oceania

####Gapminder's details

```{r}
gapminder %>% 
  count( continent )
nrow( gapminder )
nlevels( gapminder$continent )
nlevels( gapminder$country )
```

####Oceania's details (for manual validation)

```{r}
just_oceania <- gapminder %>%
  filter( continent == "Oceania" ) %>%
  droplevels()
just_oceania %>%
  count( continent )
nrow( just_oceania )
nlevels( just_oceania$continent )
nlevels( just_oceania$country )
```

####Details after dropping Oceania

```{r}
# Dropping Oceania and it's factor levels
(without_oceania <- gapminder %>%
  filter( continent != "Oceania" ) %>%
  droplevels())
# The tibble shows that Oceania has been removed
without_oceania %>%
  count( continent )
# 1704 - 24 (Observations for all continents - Observations for Oceania)
nrow( without_oceania )
# 5 - 1 (All continents - Oceania)
nlevels( without_oceania$continent )
# 142 - 2 (All countries - (New Zealand + Australia))
nlevels( without_oceania$country )
```

###Reordering the levels of `country`

####Extracting maximum population of Countries in Europe (between 1952 and 2007)

```{r}
europe_max_pop <- gapminder %>%
  filter( continent == "Europe" ) %>%
  group_by( country ) %>% 
  summarize( max_pop = max( pop ) ) %>%
  droplevels()

head( europe_max_pop )

nrow( europe_max_pop )

europe_max_pop$country %>%
  levels() %>%
  head()

europe_max_pop %>% 
  ggplot( aes( x = max_pop , y = country ) ) + geom_point()
```

####Reordering factor levels of European countries based on descending order of maximum population

```{r}
pop_desc_reorder <- fct_reorder( europe_max_pop$country , europe_max_pop$max_pop , .desc = TRUE ) %>%
  levels()

head(pop_desc_reorder)
```

####Exploring the effects of `arrange()`

```{r}
pop_desc_data <- europe_max_pop %>% arrange( desc( max_pop ) ) 

head(pop_desc_data)

pop_desc_data$country %>% 
  levels() %>% 
  head()

pop_desc_data %>%
  ggplot( aes( x = max_pop , y = country ) ) + geom_point()
```

####Exploring the effects of reordering a factor( without `arrange()`)

```{r}
europe_max_pop$country %>%
  levels() %>%
  head()

europe_max_pop %>% 
  ggplot( aes( x = max_pop , y = fct_reorder( country,max_pop ) ) ) + geom_point()
```

####Exploring the effects of factor reordering with `arrange()`

```{r}
head(pop_desc_data)

pop_desc_data %>% 
  ggplot( aes( x = max_pop, y = fct_reorder( country,max_pop ) ) ) + geom_point()
```

